language: node_js
node_js:
- '8'
jobs:
  include:
  - stage: test
    script: npm run test
  - stage: build
    script: npm run build
  - stage: heroku
    script: skip
    deploy:
      provider: heroku
      api_key: $HEROKU_API_KEY
      app: cherrypieapp
  - stage: surge
    script: npm run build
    deploy:
      provider: surge
      project: ./dist/
      domain: cherrypie.surge.sh
      skip_cleanup: true

